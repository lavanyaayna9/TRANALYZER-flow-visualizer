-- Return a list of unique ASNs

SELECT DISTINCT asn

FROM (
    SELECT
        "srcIPASN" AS asn
    FROM
        flow
    WHERE
        ("flowStat"::BIGINT & x'c000'::BIGINT) > 0::BIGINT  -- IPv4/6 only
        AND "timeFirst" >= to_timestamp(:time_from)
        AND "timeLast" <= to_timestamp(:time_to)

    UNION ALL

    SELECT
        "dstIPASN" AS asn
    FROM
        flow
    WHERE
        ("flowStat"::BIGINT & x'c000'::BIGINT) > 0::BIGINT  -- IPv4/6 only
        AND "timeFirst" >= to_timestamp(:time_from)
        AND "timeLast" <= to_timestamp(:time_to)
) AS asns
