noinst_LTLIBRARIES = libndpi.la

CFLAGS += -w          # --silence nDPI warnings
CFLAGS += -fPIC -DPIC # --coverage
libndpi_la_CPPFLAGS = -I$(top_srcdir)/src/include/  -I$(top_srcdir)/src/lib/third_party/include/

libndpi_la_includedir = $(includedir)/libndpi-@VERSION@/libndpi

libndpi_la_include_HEADERS = ../include/ndpi_api.h \
    ../include/ndpi_classify.h \
    ../include/ndpi_encryption.h \
    ../include/ndpi_includes.h \
    ../include/ndpi_includes_OpenBSD.h \
    ../include/ndpi_main.h \
    ../include/ndpi_patricia_typedefs.h \
    ../include/ndpi_private.h \
    ../include/ndpi_protocol_ids.h \
    ../include/ndpi_replace_printf.h \
    ../include/ndpi_typedefs.h \
    ../include/ndpi_unix.h \
    ../include/ndpi_win32.h \
    third_party/include/ahocorasick.h \
    third_party/include/binaryfusefilter.h \
    third_party/include/gcrypt_light.h \
    third_party/include/hll.h \
    third_party/include/libcache.h \
    third_party/include/libinjection.h \
    third_party/include/libinjection_html5.h \
    third_party/include/libinjection_sqli_data.h \
    third_party/include/libinjection_sqli.h \
    third_party/include/libinjection_xss.h \
    third_party/include/MurmurHash3.h \
    third_party/include/ndpi_md5.h \
    third_party/include/ndpi_patricia.h \
    third_party/include/ndpi_sha1.h \
    third_party/include/ndpi_sha256.h \
    third_party/include/pl7m.h \
    third_party/include/rce_injection.h \
    third_party/include/roaring.h \
    third_party/include/roaring_v2.h \
    third_party/include/secure_memzero.h \
    third_party/include/shoco_domains_model.h \
    third_party/include/shoco.h \
    third_party/include/uthash.h

libndpi_la_SOURCES = ./ndpi_analyze.c \
    ./ndpi_binary_bitmap.c \
    ./ndpi_bitmap64_fuse.c \
    ./ndpi_bitmap.c \
    ./ndpi_classify.c \
    ./ndpi_community_id.c \
    ndpi_content_match.c.inc \
    ./ndpi_domain_classify.c \
    ./ndpi_domains.c \
    ./ndpi_filter.c \
    ./ndpi_geoip.c \
    ./ndpi_hash.c \
    ./ndpi_main.c \
    ./ndpi_memory.c \
    ./ndpi_serializer.c \
    ./ndpi_utils.c \
    protocols/activision.c \
    protocols/afp.c \
    protocols/ajp.c \
    protocols/alicloud.c \
    protocols/amazon_video.c \
    protocols/among_us.c \
    protocols/amqp.c \
    protocols/apple_push.c \
    protocols/armagetron.c \
    protocols/avast.c \
    protocols/avast_securedns.c \
    protocols/bacnet.c \
    protocols/beckhoff_ads.c \
    protocols/bfcp.c \
    protocols/bfd.c \
    protocols/bgp.c \
    protocols/bitcoin.c \
    protocols/bittorrent.c \
    protocols/bjnp.c \
    protocols/btlib.c \
    protocols/c1222.c \
    protocols/can.c \
    protocols/capwap.c \
    protocols/cassandra.c \
    protocols/ceph.c \
    protocols/checkmk.c \
    protocols/cip.c \
    protocols/ciscovpn.c \
    protocols/citrix.c \
    protocols/cloudflare_warp.c \
    protocols/coap.c \
    protocols/cod_mobile.c \
    protocols/collectd.c \
    protocols/corba.c \
    protocols/cpha.c \
    protocols/crossfire.c \
    protocols/crynet.c \
    protocols/dcerpc.c \
    protocols/dhcp.c \
    protocols/dhcpv6.c \
    protocols/diameter.c \
    protocols/discord.c \
    protocols/dlep.c \
    protocols/dnp3.c \
    protocols/dns.c \
    protocols/dnscrypt.c \
    protocols/dofus.c \
    protocols/drda.c \
    protocols/dropbox.c \
    protocols/eaq.c \
    protocols/edonkey.c \
    protocols/egd.c \
    protocols/elastic_search.c \
    protocols/epicgames.c \
    protocols/ethereum.c \
    protocols/ethernet_ip.c \
    protocols/ethersbus.c \
    protocols/ethersio.c \
    protocols/fastcgi.c \
    protocols/fins.c \
    protocols/fix.c \
    protocols/flute.c \
    protocols/ftp_control.c \
    protocols/ftp_data.c \
    protocols/gaijin_entertainment.c \
    protocols/gearman.c \
    protocols/genshin_impact.c \
    protocols/git.c \
    protocols/gnutella.c \
    protocols/gtp.c \
    protocols/guildwars.c \
    protocols/h323.c \
    protocols/halflife2_and_mods.c \
    protocols/haproxy.c \
    protocols/hart-ip.c \
    protocols/hislip.c \
    protocols/hl7.c \
    protocols/hots.c \
    protocols/hpvirtgrp.c \
    protocols/hsrp.c \
    protocols/http2.c \
    protocols/http.c \
    protocols/i3d.c \
    protocols/iax.c \
    protocols/icecast.c \
    protocols/iec60870-5-104.c \
    protocols/iec62056.c \
    protocols/ieee-c37118.c \
    protocols/imo.c \
    protocols/ipp.c \
    protocols/ipsec.c \
    protocols/iqiyi.c \
    protocols/irc.c \
    protocols/iso9506-1-mms.c \
    protocols/jabber.c \
    protocols/jrmi.c \
    protocols/json-rpc.c \
    protocols/kafka.c \
    protocols/kakaotalk_voice.c \
    protocols/kcp.c \
    protocols/kerberos.c \
    protocols/kismet.c \
    protocols/knxnet_ip.c \
    protocols/ldap.c \
    protocols/ldp.c \
    protocols/line.c \
    protocols/lisp.c \
    protocols/lol_wild_rift.c \
    protocols/lotus_notes.c \
    protocols/mail_imap.c \
    protocols/mail_pop.c \
    protocols/mail_smtp.c \
    protocols/maplestory.c \
    protocols/megaco.c \
    protocols/memcached.c \
    protocols/merakicloud.c \
    protocols/mgcp.c \
    protocols/mining.c \
    protocols/modbus.c \
    protocols/monero.c \
    protocols/mongodb.c \
    protocols/mpegdash.c \
    protocols/mpegts.c \
    protocols/mqtt.c \
    protocols/mssql_tds.c \
    protocols/mumble.c \
    protocols/munin.c \
    protocols/mysql.c \
    protocols/nano.c \
    protocols/natpmp.c \
    protocols/nats.c \
    protocols/nest_log_sink.c \
    protocols/netbios.c \
    protocols/netease_games.c \
    protocols/netflow.c \
    protocols/nfs.c \
    protocols/nintendo.c \
    protocols/noe.c \
    protocols/nomachine.c \
    protocols/non_tcp_udp.c \
    protocols/ntp.c \
    protocols/oicq.c \
    protocols/ookla.c \
    protocols/opc-ua.c \
    protocols/openflow.c \
    protocols/openvpn.c \
    protocols/openwire.c \
    protocols/oracle.c \
    protocols/path_of_exile.c \
    protocols/pfcp.c \
    protocols/postgres.c \
    protocols/pptp.c \
    protocols/profinet_io.c \
    protocols/protobuf.c \
    protocols/ptpv2.c \
    protocols/qq.c \
    protocols/quic.c \
    protocols/radius_proto.c \
    protocols/radmin.c \
    protocols/raft.c \
    protocols/raknet.c \
    protocols/rdp.c \
    protocols/resp.c \
    protocols/riotgames.c \
    protocols/ripe_atlas.c \
    protocols/rmcp.c \
    protocols/roughtime.c \
    protocols/rsh.c \
    protocols/rsync.c \
    protocols/rtmp.c \
    protocols/rtp.c \
    protocols/rtps.c \
    protocols/rtsp.c \
    protocols/rx.c \
    protocols/s7comm.c \
    protocols/sd_rtn.c \
    protocols/sflow.c \
    protocols/sip.c \
    protocols/skinny.c \
    protocols/slp.c \
    protocols/smb.c \
    protocols/smpp.c \
    protocols/snmp_proto.c \
    protocols/soap.c \
    protocols/socks45.c \
    protocols/softether.c \
    protocols/someip.c \
    protocols/source_engine.c \
    protocols/spotify.c \
    protocols/ssdp.c \
    protocols/ssh.c \
    protocols/starcraft.c \
    protocols/steam.c \
    protocols/steam_datagram_relay.c \
    protocols/stomp.c \
    protocols/stun.c \
    protocols/syncthing.c \
    protocols/syslog.c \
    protocols/tailscale.c \
    protocols/tcp_udp.c \
    protocols/teamspeak.c \
    protocols/teamviewer.c \
    protocols/telegram.c \
    protocols/telnet.c \
    protocols/tencent_games.c \
    protocols/teredo.c \
    protocols/teso.c \
    protocols/tftp.c \
    protocols/threema.c \
    protocols/thrift.c \
    protocols/tinc.c \
    protocols/tivoconnect.c \
    protocols/tls.c \
    protocols/tocaboca.c \
    protocols/tplink_shp.c \
    protocols/tuya_lp.c \
    protocols/ubntac2.c \
    protocols/uftp.c \
    protocols/ultrasurf.c \
    protocols/usenet.c \
    protocols/vhua.c \
    protocols/viber.c \
    protocols/vmware.c \
    protocols/vnc.c \
    protocols/vxlan.c \
    protocols/warcraft3.c \
    protocols/websocket.c \
    protocols/whatsapp.c \
    protocols/whoisdas.c \
    protocols/wireguard.c \
    protocols/world_of_kung_fu.c \
    protocols/world_of_warcraft.c \
    protocols/wsd.c \
    protocols/xbox.c \
    protocols/xdmcp.c \
    protocols/xiaomi.c \
    protocols/yojimbo.c \
    protocols/z3950.c \
    protocols/zabbix.c \
    protocols/zattoo.c \
    protocols/zeromq.c \
    protocols/zoom.c \
    protocols/zug.c \
    third_party/src/ahocorasick.c \
    third_party/src/gcrypt_light.c \
    third_party/src/hll/hll.c \
    third_party/src/hll/MurmurHash3.c \
    third_party/src/libcache.c \
    third_party/src/libinjection_html5.c \
    third_party/src/libinjection_sqli.c \
    third_party/src/libinjection_xss.c \
    third_party/src/ndpi_md5.c \
    third_party/src/ndpi_patricia.c \
    third_party/src/ndpi_sha1.c \
    third_party/src/ndpi_sha256.c \
    third_party/src/roaring.c \
    third_party/src/roaring_v2.c \
    third_party/src/sha1-fast.c \
    third_party/src/shoco.c \
    third_party/src/strptime.c
