\IfFileExists{t2doc.cls}{
    \documentclass[documentation]{subfiles}
}{
    \errmessage{Error: could not find t2doc.cls}
}

\begin{document}

\trantitle
    {igmpDecode}
    {Internet Group Management Protocol (IGMP)}
    {Tranalyzer Development Team}

\section{igmpDecode}\label{s:igmpDecode}

\subsection{Description}
This plugin analyzes IGMP traffic and provides absolute and relative statistics to the {\tt PREFIX\_igmpStats.txt} file.

\subsection{Required Files}
None

\subsection{Configuration Flags}
The following flags can be used to control the output of the plugin:
\begin{longtable}{>{\tt}lcl}
    \toprule
    {\bf Name} & {\bf Default} & {\bf Description} \\
    \midrule\endhead%
    %IGMP\_TC\_MD &  0 & Type code\\
    %IGMP\_NUM    & 10 & Type code\\
    \hyperref[igmpDecode:additonalOutput]{IGMP\_STATFILE}
                   & 1  & Print IGMP statistics in a separate file\\
    IGMP\_NOCODE   & {\tt\small "-"}
                        & Symbol to use to represent the absence of a code\\
    IGMP\_SUFFIX   & {\tt\small "\_igmpStats.txt"}
                        & Suffix for output file\\
    \bottomrule
\end{longtable}

\subsubsection{Environment Variable Configuration Flags}
The following configuration flags can also be configured with environment variables ({\tt ENVCNTRL>0}):
\begin{itemize}
    \item {\tt IGMP\_NOCODE}
    \item {\tt IGMP\_SUFFIX}
\end{itemize}

\subsection{Flow File Output}
The igmpDecode plugin outputs the following columns:
\begin{longtable}{>{\tt}lll>{\tt\small}l}
    \toprule
    {\bf Column} & {\bf Type} & {\bf Description} & {\bf Flags}\\
    \midrule\endhead%
    \nameref{igmpStat} & H8  & Status\\
    igmpVersion       & RI8 & Version\\
    igmpAType         & H32 & Aggregated type \\%& {\tt IGMP\_TC\_MD=0}\\
    igmpMCastAddr     & IP4 & Multicast address\\
    igmpNRec          & U16 & Number of records\\
    \bottomrule
\end{longtable}

\subsubsection{igmpStat}\label{igmpStat}
The {\tt igmpStat} column is to be interpreted as follows:
\begin{longtable}{>{\tt}rl}
    \toprule
    {\bf igmpStat} & {\bf Description} \\
    \midrule\endhead%
    $2^0$ (=0x01) & IGMP message had invalid length\\
    $2^1$ (=0x02) & IGMP message had invalid checksum\\
    $2^2$ (=0x04) & IGMP message had invalid TTL ($\neq1$)\\
    $2^3$ (=0x08) & IGMP message was invalid for other reasons\\
    \bottomrule
\end{longtable}

\subsection{Plugin Report Output}
The following information is reported:
\begin{itemize}
    \item Aggregated {\tt\nameref{igmpStat}}
    \item Number of IGMP packets
    \item Number of IGMP queries
    \item Number of IGMP reports
    \item IGMP query / report ratio
\end{itemize}

\subsection{Additional Output}\label{igmpDecode:additonalOutput}
The plugin exports global statistics about IGMP traffic in the {\tt PREFIX\_igmpStats.txt} file.
Note that the default suffix of ``{\tt \_igmpStats.txt}'' can be changed  by editing the {\tt IGMP\_SUFFIX} flag.

\subsection{Post-Processing}
The {\tt\tranref{protStat}} script can be used to sort the {\tt PREFIX\_igmpStats.txt} file for the most or least occurring types and codes.
It can output the top or bottom $N$ protocols or only those with at least a given percentage:
\begin{itemize}
    \item list all the options: {\tt protStat --{}--help}
    \item for better readability, use {\tt protStat} with {\tt tcol}: {\tt protStat ... | tcol}
    \item sorted list of types (by packets): {\tt protStat PREFIX\_igmpStats.txt}
    \item top 10 IGMP types and codes (by packets): {\tt protStat PREFIX\_igmpStats.txt --n 10}
    \item bottom 5 IGMP types and codes (by packets): {\tt protStat PREFIX\_igmpStats.txt --n --5}
    \item IGMP types and codes with packets percentage greater than 20\%: {\tt protStat PREFIX\_igmpStats.txt --p 20}
    \item IGMP types and codes with packets percentage smaller than 5\%: {\tt protStat PREFIX\_igmpStats.txt --p --5}
\end{itemize}


\end{document}
