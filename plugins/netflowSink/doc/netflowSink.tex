\IfFileExists{t2doc.cls}{
    \documentclass[documentation]{subfiles}
}{
    \errmessage{Error: could not find t2doc.cls}
}

\begin{document}

\trantitle
    {netflowSink}
    {Output to any NetFlow collector}
    {Tranalyzer Development Team}

\section{netflowSink}\label{s:netflowSink}

\subsection{Description}
This plugin is an interface of Tranalyzer to a NetFlow collector.

\subsection{Dependencies}

\subsubsection{Other Plugins}
This plugin requires the \tranrefpl{basicFlow}, \tranrefpl{basicStats} and \tranrefpl{tcpFlags} plugins.\\
In addition, the \tranrefpl{macRecorder} plugin is recommended, but optional.

\subsection{Configuration Flags}
The following flags can be used to control the output of the plugin:

%\subsection{netflowSink.h}
\begin{longtable}{>{\tt}lcl}
    \toprule
    {\bf Name} & {\bf Default} & {\bf Description}\\
    \midrule\endhead%
    NF\_SERVADD   & {\tt\small "127.0.0.1"} & Destination address\\
    NF\_DPORT     & 9995                    & Destination port\\
    NF\_SOCKTYPE  & 0                       & Socket type: 0: UDP; 1: TCP\\
    NF\_VER       & 9                       & NetFlow version 9 or 10 (IPFIX)\\
    NF\_NUM4FLWS  & 200                     & Max \# of IPv4 flows in one message\\
    NF\_NUM6FLWS  & 100                     & Max \# of IPv6 flows in one message\\
    \bottomrule
\end{longtable}

\subsubsection{Environment Variable Configuration Flags}
The following configuration flags can also be configured with environment variables ({\tt ENVCNTRL>0}):
\begin{itemize}
    \item {\tt NF\_NUM4FLWS}
    \item {\tt NF\_NUM6FLWS}
    \item {\tt NF\_SERVADD}
    \item {\tt NF\_DPORT}
\end{itemize}

\subsection{Example}
To collect T2 flow data with {\bf nfcapd}, use the following command:
\begin{center}
{\tt nfcapd -T all -B 1000000 -n wurst,127.0.0.1,.}
\end{center}

%\subsection{TODO}
%
%\begin{itemize}
%   \item
%\end{itemize}

\end{document}
