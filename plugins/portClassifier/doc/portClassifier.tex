\IfFileExists{t2doc.cls}{
    \documentclass[documentation]{subfiles}
}{
    \errmessage{Error: could not find 't2doc.cls'}
}

\begin{document}

\trantitle
    {portClassifier}
    {Classification Based on Port Number}
    {Tranalyzer Development Team} % author(s)

\section{portClassifier}\label{s:portClassifier}

\subsection{Description}
The portClassifier plugin classifies the flow according to the destination port meaning. It accepts a default port list {\tt portmap.txt}, automatically installed with the plugin.

\subsection{Dependencies}

\subsubsection{Required Files}
The file {\tt portmap.txt} is required.

\subsection{Configuration Flags}
The following flags can be used to control the output of the plugin:
\begin{longtable}{>{\tt}lcl}
    \toprule
    {\bf Name} & {\bf Default} & {\bf Description} \\
    \midrule\endhead%
    PBC\_NUM       &  1 & Print string representation of port classification\\
    PBC\_STR       &  1 & Print numeric representation of port classification\\
    PBC\_CLASSFILE & {\tt\small "portmap.txt"}
                        & input file for the mapping between ports and applications\\
    PBC\_UNKNOWN   & {\tt\small "unknown"}
                        & Label for unknown ports\\
    \bottomrule
\end{longtable}

\subsubsection{Environment Variable Configuration Flags}
The following configuration flags can also be configured with environment variables ({\tt ENVCNTRL>0}):
\begin{itemize}
    \item {\tt PBC\_CLASSFILE}
    \item {\tt PBC\_UNKNOWN}
\end{itemize}

\subsection{Flow File Output}
The portClassifier plugin outputs the following columns:
\begin{longtable}{>{\tt}lll>{\tt\small}l}
    \toprule
    {\bf Column} & {\bf Type} & {\bf Description} & {\bf Flags}\\
    \midrule\endhead%
    dstPortClassN & U16 & Port based classification of the destination port number & PBC\_NUM=0\\
    dstPortClass  & SC  & Port based classification of the destination port name   & PBC\_STR=1\\
    \bottomrule
\end{longtable}

\subsection{Packet File Output}
In packet mode ({\tt --s} option), the portClassifier plugin outputs the following columns:
\begin{longtable}{>{\tt}lll>{\tt\small}l}
    \toprule
    {\bf Column} & {\bf Type} & {\bf Description} & {\bf Flags}\\
    \midrule\endhead%
    dstPortClassN & U16 & Port based classification of the destination port number & PBC\_NUM=0\\
    dstPortClass  & SC  & Port based classification of the destination port name   & PBC\_STR=1\\
    \bottomrule
\end{longtable}

\end{document}
